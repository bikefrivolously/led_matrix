/*
 * led_matrix.c
 *
 *  Created on: Sep 6, 2018
 *      Author: dmartins
 */

#include "led_matrix.h"

#include <stdio.h>
#include <stdint.h>

#include "stm32f4xx_hal.h"
#include "stm32f4xx_ll_gpio.h"


uint8_t frame[] = {
	    0x12,0x14,0x14,0x12,0xf,0xc,0xa,0x5,0x1,0x1,0x1,0x1,0x2,0x3,0x2,0x1,0x1,0x1,0x2,0x5,0x3,0x2,0x2,0x5,0x9,0xc,0xe,0x11,0x14,0x16,0x17,0x19,0x1a,0x1b,0x1c,0x1c,0x1c,0x1a,0xf,0x4,0x3,0x10,0x11,0x14,0xd,0x6,0xb,0xe,0xc,0x9,0x8,0x5,0x5,0x5,0x7,0x7,0xb,0x11,0x13,0x15,0x15,0xd,0x4,0xc,
	    0x12,0x15,0x15,0x13,0xf,0xd,0xa,0x6,0x2,0x1,0x1,0x1,0x3,0x2,0x1,0x1,0x1,0x1,0x5,0x4,0x1,0x1,0x4,0x9,0xc,0xd,0xc,0xc,0xb,0xc,0x11,0x17,0x1a,0x1b,0x1c,0x1c,0x1b,0x1b,0x10,0x5,0x2,0x10,0x12,0x13,0xd,0x7,0xb,0xe,0xc,0x9,0x8,0x6,0x5,0x6,0x7,0x7,0xa,0x10,0x12,0x15,0x17,0xf,0x4,0xd,
	    0x13,0x15,0x15,0x12,0xf,0xd,0xa,0x6,0x2,0x1,0x1,0x1,0x3,0x1,0x1,0x1,0x1,0x2,0x6,0x1,0x1,0x2,0x8,0xc,0xe,0xe,0xc,0xb,0xb,0xa,0x7,0xa,0x14,0x19,0x1b,0x1b,0x1b,0x1a,0x10,0x6,0x3,0x10,0x13,0x13,0x10,0x7,0xa,0xe,0xb,0x9,0x8,0x6,0x5,0x6,0x6,0x5,0xb,0x13,0x16,0x19,0x1a,0x13,0x4,0xd,
	    0x10,0x12,0x11,0xf,0xc,0xa,0x8,0x5,0x2,0x1,0x1,0x3,0x2,0x1,0x1,0x1,0x1,0x4,0x3,0x1,0x1,0x5,0xb,0xe,0x10,0xd,0x6,0x5,0x6,0xb,0xb,0x7,0xb,0x14,0x19,0x1a,0x18,0x18,0xe,0x7,0x4,0xf,0x15,0x12,0x12,0x8,0xd,0x10,0xc,0x9,0x8,0x6,0x6,0x7,0x7,0x6,0xc,0x16,0x19,0x1a,0x1b,0x13,0x4,0xd,
	    0xa,0xb,0xa,0x8,0x7,0x6,0x5,0x3,0x2,0x2,0x2,0x4,0x1,0x1,0x1,0x1,0x1,0x3,0x3,0x3,0x2,0x8,0xd,0xf,0x11,0xf,0x8,0x9,0xa,0x12,0xf,0xb,0xb,0x12,0x1a,0x18,0x10,0x8,0x4,0x4,0x4,0xf,0x14,0x11,0x12,0xc,0x10,0x12,0xf,0xa,0xa,0x7,0x8,0x9,0x8,0x7,0xd,0x17,0x19,0x1a,0x1b,0x13,0x4,0xd,
	    0x3,0x4,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x4,0x3,0x1,0x1,0x1,0x1,0x1,0x5,0x6,0x3,0x3,0xb,0xe,0x10,0x12,0x13,0xf,0xa,0xc,0x14,0x13,0xd,0xd,0x14,0x1c,0x10,0x5,0x5,0x6,0xa,0x4,0xe,0x14,0x11,0x11,0xd,0x10,0x13,0xf,0xb,0xb,0x9,0xa,0xb,0x9,0x6,0xd,0x16,0x19,0x1b,0x1b,0x14,0x4,0xd,
	    0x4,0x4,0x3,0x4,0x4,0x4,0x4,0x4,0x3,0x3,0x5,0x1,0x1,0x1,0x1,0x1,0x2,0x6,0x6,0x2,0x3,0xb,0xf,0x10,0x12,0x16,0x16,0x14,0x12,0x12,0x15,0x10,0xf,0x17,0x1b,0x9,0x7,0x7,0x6,0x4,0x3,0xc,0x13,0x11,0x11,0xe,0x10,0x12,0xf,0xc,0xb,0xa,0xc,0xd,0xa,0x6,0xd,0x16,0x18,0x1a,0x1b,0x14,0x4,0xd,
	    0x5,0x4,0x4,0x4,0x4,0x4,0x4,0x4,0x4,0x4,0x4,0x1,0x1,0x1,0x1,0x1,0x3,0x6,0x7,0x2,0x3,0xb,0xf,0x10,0x11,0x15,0x19,0x1a,0x19,0x18,0x16,0x13,0x13,0x18,0x1c,0x10,0xa,0x8,0x4,0x2,0x3,0x9,0x12,0x11,0x11,0x10,0x10,0x12,0xf,0xc,0xc,0xb,0xd,0xe,0xb,0x7,0xe,0x16,0x18,0x1a,0x1b,0x13,0x4,0xd,
	    0x5,0x5,0x4,0x4,0x5,0x5,0x5,0x4,0x4,0x4,0x4,0x1,0x1,0x1,0x1,0x1,0x2,0x6,0x7,0x3,0x3,0xb,0xe,0xf,0x10,0x13,0x17,0x1a,0x1a,0x18,0x14,0x13,0x12,0x19,0x1e,0x16,0xd,0x6,0x7,0x2,0x2,0x8,0x10,0x13,0x10,0x11,0x10,0x12,0xe,0xc,0xc,0xc,0xe,0xf,0xb,0x7,0xe,0x17,0x19,0x1a,0x1a,0x12,0x3,0xd,
	    0x5,0x5,0x5,0x5,0x5,0x5,0x5,0x4,0x4,0x4,0x4,0x2,0x1,0x1,0x1,0x1,0x1,0x7,0x8,0x5,0x2,0xb,0xe,0xf,0x10,0x12,0x15,0x18,0x19,0x18,0x11,0xf,0x11,0x1a,0x1e,0x1a,0x14,0xb,0x8,0x1,0x1,0x9,0xf,0x15,0x10,0x11,0x11,0x13,0xf,0xd,0xd,0xc,0xe,0xf,0xb,0x7,0xf,0x16,0x18,0x1a,0x1a,0x12,0x3,0xd,
	    0x5,0x5,0x5,0x5,0x4,0x5,0x4,0x4,0x4,0x4,0x4,0x2,0x1,0x1,0x1,0x2,0x1,0x7,0x9,0x7,0x2,0xa,0xe,0xf,0xf,0x11,0x13,0x16,0x17,0x12,0xc,0xf,0x11,0x1a,0x1f,0x1b,0x18,0x10,0x7,0x1,0x1,0x7,0x10,0x15,0x11,0xf,0x12,0x14,0x11,0xd,0xd,0xc,0xe,0xf,0xb,0x8,0xf,0x17,0x19,0x1a,0x1a,0x12,0x4,0xc,
	    0x5,0x5,0x4,0x4,0x4,0x4,0x4,0x4,0x3,0x4,0x3,0x2,0x1,0x1,0x1,0x2,0x1,0x7,0x9,0x8,0x3,0x9,0xe,0xf,0xf,0x10,0x12,0x14,0x14,0xc,0xd,0xc,0xd,0x15,0x1d,0x1a,0x18,0x11,0x5,0x1,0x1,0x3,0xd,0x13,0x12,0xf,0x10,0x12,0xf,0xe,0xd,0xc,0xe,0xf,0xb,0x8,0xf,0x17,0x19,0x1a,0x1a,0x12,0x4,0xc,
	    0x5,0x5,0x4,0x4,0x4,0x4,0x4,0x3,0x2,0x4,0x2,0x1,0x1,0x1,0x1,0x2,0x1,0x5,0x9,0x8,0x4,0x7,0xd,0xf,0x10,0x11,0x12,0x14,0x13,0xf,0xc,0xc,0xe,0x15,0x19,0x18,0x18,0xf,0x3,0x2,0x1,0x6,0xd,0xe,0x11,0xe,0xe,0x10,0xf,0xe,0xd,0xc,0xe,0xf,0xb,0x8,0xf,0x16,0x18,0x19,0x18,0x10,0x3,0xa,
	    0x5,0x4,0x4,0x4,0x4,0x4,0x3,0x1,0x3,0x3,0x1,0x1,0x1,0x1,0x2,0x3,0x0,0x4,0x9,0x9,0x5,0x6,0xc,0xf,0x10,0x11,0x11,0x13,0x14,0x13,0x12,0x17,0x18,0x1d,0x1b,0x17,0x14,0x7,0x5,0x5,0x1,0x3,0xc,0xa,0x10,0xe,0xf,0x12,0x10,0xe,0xd,0xc,0xe,0xf,0xb,0x8,0xd,0x12,0x14,0x15,0x14,0xd,0x3,0x4,
	    0x5,0x4,0x4,0x4,0x4,0x3,0x1,0x3,0x3,0x3,0x1,0x1,0x1,0x2,0x2,0x3,0x1,0x2,0x9,0xa,0x6,0x5,0xb,0xe,0x10,0x11,0x11,0xf,0xe,0xd,0xd,0x14,0x19,0x1d,0x1b,0x14,0xb,0x4,0x9,0x6,0x1,0x4,0x7,0x6,0xd,0xd,0x11,0x14,0x11,0xe,0xd,0xc,0xe,0xf,0xb,0x7,0xa,0xb,0xb,0xb,0xb,0x7,0x3,0x2,
	    0x4,0x4,0x4,0x4,0x4,0x1,0x3,0x5,0x3,0x3,0x1,0x1,0x1,0x2,0x3,0x4,0x2,0x1,0x5,0xb,0x8,0x5,0x9,0xd,0xf,0x10,0x10,0xf,0xa,0xb,0xe,0xb,0xb,0x10,0x17,0xd,0x4,0x8,0xe,0x5,0x2,0x5,0x2,0x5,0xb,0xd,0x11,0x16,0x13,0xe,0xd,0xc,0xf,0xf,0xb,0x7,0xc,0xc,0xc,0xd,0xd,0xa,0x5,0x7,
	    0x4,0x4,0x4,0x4,0x3,0x2,0x3,0x5,0x4,0x2,0x1,0x1,0x1,0x1,0x3,0x3,0x3,0x1,0x3,0xa,0x9,0x6,0x7,0xc,0xe,0xf,0x10,0xf,0xc,0xc,0x13,0x14,0x16,0x12,0x10,0x8,0x2,0x9,0x10,0x5,0x4,0x7,0x1,0x4,0xb,0xc,0x12,0x17,0x14,0xe,0xd,0xc,0xf,0xf,0xc,0xa,0x14,0x16,0x17,0x19,0x1a,0x15,0xb,0xf,
	    0x5,0x4,0x4,0x4,0x3,0x1,0x2,0x5,0x4,0x2,0x1,0x1,0x1,0x1,0x3,0x3,0x3,0x1,0x3,0x6,0xa,0x7,0x3,0x9,0xd,0xe,0xf,0xf,0xf,0xd,0xc,0xf,0x11,0x13,0xb,0x4,0x2,0x5,0x10,0x6,0x5,0xc,0x4,0x7,0x10,0xa,0x13,0x19,0x16,0xe,0xd,0xc,0xe,0xf,0xc,0xe,0x1a,0x1b,0x1b,0x1c,0x1d,0x1a,0xf,0x13,
	    0x4,0x4,0x3,0x3,0x3,0x2,0x2,0x5,0x4,0x2,0x1,0x1,0x1,0x1,0x1,0x3,0x3,0x1,0x3,0x3,0x9,0x7,0x3,0x6,0xb,0xe,0x10,0x11,0x14,0x17,0x18,0x16,0x14,0xe,0x6,0x1,0x2,0x2,0xe,0x5,0x9,0xe,0x5,0xf,0x11,0x8,0x13,0x18,0x15,0xf,0xd,0xc,0xe,0xf,0xc,0x10,0x1c,0x1c,0x1b,0x1c,0x1d,0x1a,0x10,0x14,
	    0x3,0x3,0x2,0x2,0x2,0x3,0x5,0x7,0x4,0x3,0x1,0x2,0x1,0x1,0x1,0x3,0x2,0x1,0x2,0x3,0x7,0x7,0x5,0x3,0x7,0xb,0xe,0x10,0x13,0x17,0x19,0x19,0x11,0x6,0x1,0x1,0x2,0x1,0x9,0xe,0xd,0xd,0xd,0x10,0xa,0x7,0x10,0x16,0x13,0xf,0xe,0xc,0xe,0xf,0xc,0x10,0x1c,0x1c,0x1b,0x1c,0x1d,0x1b,0x11,0x14,
	    0x3,0x2,0x2,0x2,0x2,0x2,0x6,0x8,0x5,0x3,0x1,0x2,0x2,0x1,0x1,0x1,0x2,0x1,0x2,0x3,0x4,0x7,0x6,0x4,0x5,0x6,0x9,0xc,0xe,0x11,0x14,0x13,0x7,0x1,0x1,0x1,0x1,0x2,0x4,0xe,0xf,0x7,0xe,0x8,0x6,0x5,0xa,0xf,0xf,0x10,0xe,0xc,0xe,0xe,0xc,0xf,0x1a,0x1c,0x1b,0x1c,0x1d,0x1b,0x12,0x15,
	    0x3,0x2,0x2,0x4,0x4,0x3,0x6,0x9,0x6,0x4,0x2,0x2,0x2,0x1,0x1,0x1,0x1,0x1,0x1,0x3,0x3,0x5,0x5,0x6,0x6,0x7,0x6,0x6,0x6,0x6,0x6,0x2,0x1,0x1,0x1,0x1,0x2,0x2,0x2,0xa,0x11,0x6,0x6,0x8,0x7,0x6,0x7,0x8,0xb,0x10,0xf,0xc,0xe,0xe,0xc,0xe,0x19,0x1b,0x1b,0x1c,0x1d,0x1b,0x12,0x17,
	    0x3,0x3,0x3,0x3,0x4,0x3,0x5,0x7,0x5,0x5,0x5,0x2,0x1,0x1,0x1,0x1,0x2,0x1,0x1,0x2,0x2,0x4,0x5,0x8,0x7,0x8,0x7,0x5,0x3,0x1,0x0,0x0,0x0,0x1,0x1,0x2,0x2,0x4,0x3,0x8,0x12,0xf,0x3,0x6,0x9,0x8,0x5,0x5,0xa,0x10,0xf,0xc,0xe,0xe,0xc,0xc,0x18,0x1b,0x1b,0x1c,0x1d,0x1a,0x13,0x18,
	    0x3,0x3,0x3,0x2,0x3,0x3,0x3,0x5,0x5,0x4,0x6,0x5,0x1,0x1,0x1,0x1,0x1,0x0,0x1,0x2,0x2,0x3,0x5,0x8,0x8,0x8,0x7,0x5,0x2,0x1,0x1,0x1,0x0,0x1,0x2,0x2,0x2,0x3,0x3,0xa,0x10,0x12,0xf,0x8,0xa,0xf,0x10,0xe,0xa,0xe,0xe,0xb,0xd,0xe,0xb,0xb,0x17,0x1a,0x1b,0x1d,0x1d,0x17,0x11,0x17,
	    0x2,0x2,0x2,0x2,0x2,0x2,0x4,0x4,0x4,0x4,0x4,0x7,0x2,0x2,0x2,0x2,0x1,0x1,0x1,0x1,0x1,0x2,0x5,0x9,0x9,0x8,0x7,0x4,0x2,0x1,0x1,0x1,0x2,0x1,0x1,0x2,0x0,0x2,0x2,0x7,0x11,0x11,0xe,0xd,0x9,0xe,0x14,0x17,0x19,0x12,0xb,0x9,0xb,0xd,0xb,0xa,0x16,0x1a,0x1b,0x1d,0x1b,0x13,0x11,0x16,
	    0x2,0x2,0x2,0x2,0x3,0x4,0x5,0x3,0x5,0x3,0x3,0x6,0x6,0x2,0x3,0x2,0x1,0x1,0x1,0x2,0x1,0x2,0x6,0xa,0x9,0x8,0x5,0x3,0x2,0x1,0x1,0x2,0x2,0x2,0x2,0x1,0x1,0x1,0x3,0x8,0xd,0x11,0x6,0xb,0xb,0xe,0x11,0x16,0x1b,0x1d,0x14,0x8,0x9,0xc,0xa,0xb,0x16,0x1a,0x1b,0x1d,0x1b,0x13,0x12,0x18,
	    0x2,0x2,0x2,0x3,0x4,0x5,0x3,0x3,0x3,0x2,0x3,0x4,0x4,0x4,0x3,0x3,0x1,0x1,0x2,0x2,0x1,0x2,0x7,0xa,0x8,0x7,0x5,0x4,0x1,0x1,0x1,0x1,0x5,0x2,0x2,0x3,0x3,0x2,0x2,0x8,0xd,0xe,0xa,0x7,0x8,0xa,0xd,0x12,0x1a,0x1e,0x1e,0x10,0x7,0x9,0x9,0xa,0x16,0x1a,0x1b,0x1c,0x1b,0x13,0x14,0x19,
	    0x3,0x3,0x3,0x3,0x4,0x5,0x3,0x3,0x1,0x2,0x2,0x2,0x3,0x3,0x4,0x1,0x1,0x3,0x3,0x1,0x1,0x3,0x7,0xa,0x8,0x6,0x5,0x3,0x2,0x1,0x1,0x1,0x4,0x4,0x2,0x4,0x4,0x1,0x1,0x8,0x8,0xa,0x9,0x8,0x8,0x7,0xa,0x12,0x1a,0x1f,0x1f,0x1c,0x7,0x7,0x8,0x8,0x12,0x17,0x1a,0x1b,0x1a,0x11,0x12,0x18,
	    0x3,0x4,0x4,0x4,0x3,0x3,0x2,0x1,0x1,0x3,0x2,0x2,0x3,0x5,0x4,0x2,0x2,0x2,0x2,0x1,0x3,0x5,0x6,0x9,0x7,0x6,0x5,0x2,0x3,0x1,0x1,0x0,0x1,0x6,0x3,0x2,0x5,0x2,0x1,0x2,0x2,0x8,0xb,0xc,0x7,0x7,0xa,0x13,0x1a,0x1e,0x1f,0x1f,0x12,0x6,0x8,0xa,0xc,0x10,0x14,0x17,0x16,0xe,0x10,0x16,
	    0x5,0x5,0x5,0x6,0x2,0x3,0x2,0x1,0x3,0x4,0x2,0x2,0x2,0x7,0x7,0x3,0x2,0x1,0x2,0x4,0x5,0x5,0x6,0x9,0x7,0x6,0x5,0x2,0x4,0x3,0x1,0x0,0x1,0x3,0x5,0x3,0x4,0x3,0x2,0x1,0x5,0x8,0xa,0xb,0x9,0xa,0xf,0x14,0x18,0x1c,0x1e,0x1f,0x18,0x6,0xa,0xd,0xc,0xa,0xb,0xd,0xc,0x9,0x10,0x15,
	    0xb,0xb,0xb,0x8,0x1,0x3,0x2,0x3,0x4,0x4,0x2,0x2,0x3,0x7,0x8,0x4,0x6,0x5,0x5,0x5,0x6,0x6,0x8,0xa,0x8,0x6,0x7,0x4,0x6,0x5,0x2,0x1,0x1,0x3,0x2,0x4,0x5,0x4,0x3,0x2,0x8,0x6,0x7,0x8,0xc,0xd,0xd,0x13,0x18,0x1a,0x1c,0x1e,0x1c,0x6,0x9,0xe,0xe,0xc,0x9,0x7,0x6,0x7,0xc,0x11,
	    0xf,0xf,0xf,0x5,0x2,0x4,0x4,0x7,0x7,0x4,0x3,0x3,0x5,0x6,0x6,0x5,0x8,0x9,0x8,0x8,0x7,0x9,0xb,0xa,0x9,0x8,0x8,0x4,0x5,0x4,0x5,0x1,0x2,0x3,0x3,0x3,0x2,0x4,0x6,0x6,0xa,0x4,0x2,0x7,0x11,0xe,0x10,0x13,0x18,0x1a,0x1b,0x1d,0x1e,0xc,0x9,0xe,0xe,0xd,0xc,0xa,0x7,0x6,0x6,0x8,
	    0x11,0x11,0xd,0x4,0xa,0x8,0x6,0xa,0x6,0xa,0x7,0x5,0x5,0x6,0x5,0x6,0x9,0xc,0xd,0xc,0x9,0xd,0xe,0xd,0xa,0x9,0x8,0x4,0x5,0x3,0x4,0x2,0x1,0x3,0x3,0x2,0x2,0x7,0xc,0xc,0x6,0x2,0x2,0xf,0x15,0x17,0x17,0x12,0x1a,0x1a,0x1b,0x1d,0x1e,0x13,0x8,0xd,0xe,0xe,0xd,0xc,0xb,0x9,0x8,0x6,
	    0x12,0x11,0xc,0x9,0xb,0xa,0x9,0xb,0xe,0xd,0x8,0x7,0x5,0x8,0x5,0x6,0xb,0xe,0xe,0xc,0xc,0xd,0xe,0xe,0xb,0xa,0x9,0x5,0x5,0x2,0x3,0x3,0x1,0x2,0x2,0x2,0x5,0xe,0x12,0x9,0x3,0x1,0xc,0x17,0x1b,0x1c,0x1c,0x15,0x1b,0x1c,0x1c,0x1c,0x1e,0x18,0x8,0xd,0xe,0xe,0xd,0xc,0xb,0xb,0xa,0x8,
	    0x13,0x12,0xc,0xb,0xd,0xd,0xf,0xf,0x10,0xf,0xc,0xa,0x7,0x8,0x4,0x7,0xb,0xe,0xd,0xd,0xe,0xe,0xe,0xe,0xd,0xb,0xa,0x8,0x4,0x4,0x2,0x3,0x2,0x4,0x5,0x6,0x9,0x13,0xe,0x5,0x5,0xa,0x15,0x18,0x1d,0x1e,0x1d,0x1c,0x18,0x1d,0x1d,0x1c,0x1e,0x1c,0x9,0xd,0xe,0xe,0xd,0xd,0xb,0xb,0xa,0x9,
	    0x13,0x14,0xf,0x10,0xf,0x10,0x10,0x10,0x11,0x10,0xe,0xa,0x9,0x8,0x5,0x7,0xc,0xd,0xf,0xf,0xf,0xf,0xe,0xe,0xe,0xd,0xb,0xa,0x7,0x5,0x4,0x3,0x2,0x5,0x7,0x8,0xd,0x10,0xa,0xa,0xc,0x11,0x16,0x19,0x1d,0x1f,0x1f,0x1f,0x1d,0x1e,0x1e,0x1d,0x1d,0x1e,0xc,0xd,0xe,0xd,0xd,0xd,0xc,0xb,0xa,0x9,
	    0x13,0x13,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x10,0xf,0xb,0xa,0xa,0x8,0x9,0xe,0xf,0x11,0x10,0x10,0x10,0xf,0xe,0xf,0xe,0xd,0xb,0x9,0x9,0x7,0x6,0x6,0x6,0x9,0xc,0xe,0xf,0xc,0xf,0x11,0x14,0x19,0x17,0x1c,0x1f,0x1f,0x1f,0x1f,0x1e,0x1e,0x1d,0x1d,0x1e,0x11,0xc,0xd,0xd,0xd,0xd,0xc,0xc,0xa,0x9,
	    0x12,0x12,0x10,0x11,0x11,0x11,0x11,0x11,0x11,0x10,0x10,0xc,0xb,0xc,0xb,0xc,0xf,0xe,0x11,0x11,0x11,0x10,0x10,0xf,0xf,0x10,0xf,0xc,0xb,0xb,0xa,0xb,0x7,0x9,0xd,0xc,0xf,0xd,0xd,0x10,0x11,0x12,0x15,0x14,0x19,0x1e,0x1f,0x1f,0x1f,0x1e,0x1e,0x1d,0x1d,0x1d,0x14,0xb,0xc,0xc,0xd,0xd,0xc,0xc,0xb,0xa,
	    0x11,0x12,0x10,0x10,0x10,0x11,0x11,0x11,0x11,0x11,0x10,0xd,0xc,0xe,0xd,0xd,0xf,0xe,0x12,0x12,0x12,0x11,0x11,0x11,0x10,0x10,0x10,0xd,0xe,0xe,0xc,0xc,0xd,0x7,0xd,0xb,0xd,0xc,0x7,0x9,0xf,0x14,0x16,0x15,0x19,0x1d,0x1f,0x1f,0x1f,0x1e,0x1e,0x1d,0x1d,0x1d,0x17,0xb,0xc,0xc,0xc,0xc,0xc,0xc,0xc,0xb,
	    0x11,0x11,0x11,0x10,0xf,0x10,0x10,0x11,0x11,0x11,0x11,0xe,0xd,0xe,0xe,0xe,0xe,0xf,0x10,0x12,0x12,0x12,0x12,0x12,0x11,0x10,0xf,0xf,0xf,0xf,0xe,0xc,0x9,0x9,0x8,0xc,0x7,0x9,0x9,0xf,0x16,0x18,0x19,0x19,0x18,0x1c,0x1f,0x1f,0x1d,0x1c,0x1e,0x1e,0x1d,0x1d,0x18,0xb,0xc,0xc,0xc,0xc,0xc,0xc,0xc,0xb,
	    0x10,0x11,0x11,0x10,0xf,0xf,0xf,0x10,0x11,0x11,0x11,0xe,0xd,0xf,0xf,0xe,0xe,0x11,0xe,0x14,0x14,0x13,0x13,0x13,0x12,0xe,0x12,0x10,0x10,0xf,0xe,0xc,0x9,0xb,0x9,0x9,0x8,0xb,0xc,0x14,0x19,0x1a,0x1b,0x1c,0x18,0x1b,0x1e,0x1f,0x1b,0x1a,0x1d,0x1e,0x1d,0x1c,0x18,0xa,0xb,0xb,0xb,0xb,0xc,0xc,0xb,0xb,
	    0xf,0xf,0x10,0x10,0xf,0xf,0xf,0x10,0x10,0x11,0x11,0xe,0xd,0xf,0x10,0xe,0xf,0x11,0x11,0x13,0x15,0x14,0x14,0x14,0x13,0x10,0xf,0x13,0x12,0x10,0x10,0xe,0xf,0xe,0xe,0xc,0xc,0xd,0xd,0x14,0x1a,0x1b,0x1c,0x1c,0x1c,0x1b,0x1e,0x1f,0x1a,0x18,0x1d,0x1e,0x1d,0x1c,0x18,0xa,0xb,0xb,0xb,0xb,0xc,0xc,0xc,0xc,
	    0xe,0xe,0xf,0x10,0xf,0xf,0xf,0x10,0x10,0x11,0x11,0xf,0xd,0xf,0x10,0x10,0xf,0x10,0x12,0x10,0x14,0x16,0x16,0x15,0x13,0xf,0xe,0x13,0x13,0x12,0x11,0xf,0x13,0x12,0x12,0x12,0xf,0xf,0x13,0x18,0x1a,0x1b,0x1c,0x1d,0x1e,0x1b,0x1d,0x1e,0x1b,0x16,0x1c,0x1e,0x1d,0x1c,0x18,0xa,0xa,0xa,0xb,0xb,0xb,0xb,0xb,0xb,
	    0xd,0xe,0xe,0xf,0x10,0xf,0xf,0xf,0x10,0x11,0x11,0xf,0xd,0xf,0x10,0x11,0xf,0x11,0x12,0x12,0x13,0x17,0x17,0x16,0x15,0x10,0x10,0x18,0x14,0x13,0x11,0xf,0x13,0x14,0x14,0x13,0x10,0x13,0x15,0x19,0x1b,0x1c,0x1c,0x1d,0x1e,0x1d,0x1c,0x1f,0x1d,0x16,0x1a,0x1d,0x1e,0x1c,0x18,0xa,0xa,0x9,0xa,0xb,0xb,0xb,0xb,0xb,
	    0xd,0xe,0xe,0xe,0x10,0xf,0xe,0x10,0x10,0x11,0x11,0xf,0xc,0xf,0x10,0x11,0x11,0x10,0x11,0x13,0x12,0x17,0x18,0x18,0x17,0x10,0x10,0x18,0x15,0x13,0x11,0x11,0x14,0x15,0x15,0x11,0x13,0x14,0x17,0x1a,0x1b,0x1b,0x1c,0x1d,0x1e,0x1f,0x1c,0x1e,0x1e,0x15,0x19,0x1c,0x1d,0x1c,0x19,0x9,0x9,0x9,0xa,0xa,0xa,0xa,0xa,0xa,
	    0xd,0xd,0xe,0xe,0xf,0xf,0xd,0xe,0x11,0x11,0x11,0xf,0xc,0xf,0x10,0x11,0x12,0x10,0x12,0x12,0x13,0x14,0x18,0x18,0x18,0x12,0x11,0x17,0x15,0x13,0x11,0x14,0x14,0x14,0x12,0x13,0x14,0x16,0x18,0x1a,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x1e,0x1c,0x1d,0x16,0x18,0x1b,0x1d,0x1c,0x18,0x9,0x9,0x9,0x9,0xa,0xa,0xa,0xa,0xa,
	    0xc,0xc,0xd,0xe,0xe,0xf,0xe,0xb,0x11,0x11,0x11,0xf,0xc,0xf,0x10,0x11,0x12,0x13,0x11,0x13,0x12,0x13,0x15,0x19,0x19,0x18,0x16,0x18,0x15,0x12,0x11,0x12,0x12,0x12,0x13,0x14,0x15,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1e,0x1f,0x1e,0x1d,0x1c,0x17,0x1a,0x1c,0x1c,0x18,0x9,0x8,0x8,0x8,0x9,0x9,0x9,0xa,0xa,
	    0xd,0xd,0xd,0xe,0xe,0xe,0xf,0xc,0xf,0x11,0x12,0xe,0xc,0xf,0x10,0x11,0x12,0x13,0x13,0x11,0x12,0x12,0x13,0x16,0x18,0x19,0x19,0x17,0x14,0x12,0x12,0x13,0x13,0x13,0x13,0x14,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1e,0x1e,0x1f,0x1e,0x1e,0x1b,0x19,0x1b,0x1c,0x17,0x8,0x7,0x7,0x8,0x9,0x9,0x9,0x9,0xa,
	    0xe,0xe,0xe,0xe,0xe,0xe,0xf,0xe,0xd,0x11,0x12,0xd,0xc,0xf,0x10,0x12,0x12,0x13,0x14,0x14,0x12,0x12,0x13,0x13,0x14,0x14,0x14,0x14,0x14,0x14,0x13,0x13,0x13,0x13,0x14,0x15,0x16,0x17,0x18,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1e,0x1f,0x1f,0x1e,0x1c,0x18,0x1b,0x1b,0x16,0x9,0x7,0x6,0x7,0x8,0x9,0x9,0xa,0xa,
	    0xe,0xe,0xe,0xe,0xe,0xe,0xe,0xf,0xd,0x10,0x11,0xd,0xd,0xe,0x10,0x12,0x13,0x14,0x15,0x15,0x15,0x15,0x12,0x13,0x13,0x13,0x13,0x13,0x12,0x12,0x13,0x13,0x15,0x15,0x15,0x15,0x15,0x16,0x17,0x18,0x18,0x19,0x19,0x1b,0x1c,0x1d,0x1e,0x1f,0x1f,0x1f,0x1a,0x18,0x1b,0x1b,0x15,0x8,0x7,0x5,0x7,0x8,0x9,0x9,0xa,0xa,
	    0xe,0xe,0xe,0xe,0xe,0xd,0xe,0xf,0xe,0xf,0x10,0xd,0xe,0xf,0x10,0x12,0x13,0x14,0x15,0x16,0x16,0x16,0x16,0x15,0x15,0x15,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x15,0x15,0x16,0x16,0x17,0x18,0x18,0x19,0x1a,0x1d,0x1e,0x1f,0x1f,0x1f,0x1b,0x18,0x1b,0x1b,0x14,0x8,0x6,0x5,0x7,0x9,0xa,0xa,0x9,0x9,
	    0xd,0xd,0xd,0xd,0xd,0xd,0xd,0xe,0xf,0xe,0xf,0xd,0xd,0xf,0x11,0x12,0x14,0x14,0x15,0x16,0x17,0x17,0x17,0x16,0x16,0x16,0x15,0x15,0x14,0x14,0x14,0x13,0x13,0x14,0x14,0x14,0x14,0x14,0x15,0x15,0x16,0x17,0x17,0x18,0x19,0x1c,0x1e,0x1f,0x1f,0x1f,0x1c,0x18,0x1b,0x1b,0x12,0x8,0x6,0x5,0x7,0x9,0x9,0xa,0x9,0x9,
	    0xd,0xd,0xd,0xd,0xd,0xc,0xd,0xd,0xf,0xd,0xb,0xd,0xd,0xf,0x11,0x13,0x14,0x14,0x15,0x17,0x17,0x17,0x17,0x17,0x16,0x16,0x15,0x15,0x15,0x14,0x14,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x14,0x14,0x15,0x16,0x16,0x17,0x19,0x1b,0x1d,0x1e,0x1f,0x1f,0x1c,0x17,0x1a,0x1b,0x11,0x8,0x6,0x5,0x7,0x8,0x9,0x9,0x9,0x9,
	    0xe,0xe,0xd,0xd,0xd,0xd,0xd,0xe,0xf,0xd,0xb,0xd,0xd,0x10,0x12,0x13,0x14,0x14,0x15,0x16,0x17,0x17,0x17,0x17,0x16,0x16,0x15,0x15,0x15,0x14,0x13,0x13,0x13,0x13,0x13,0x13,0x12,0x13,0x13,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1b,0x1e,0x1e,0x1f,0x1c,0x17,0x1a,0x1b,0xf,0x8,0x6,0x5,0x7,0x8,0x9,0x9,0x9,0x9,
	    0xe,0xe,0xe,0xe,0xe,0xe,0xe,0x10,0x10,0xe,0xd,0xd,0xd,0x10,0x11,0x13,0x13,0x14,0x15,0x16,0x17,0x17,0x17,0x16,0x16,0x15,0x15,0x14,0x14,0x14,0x14,0x13,0x13,0x13,0x13,0x13,0x13,0x12,0x13,0x13,0x13,0x14,0x15,0x16,0x18,0x19,0x1b,0x1d,0x1e,0x1f,0x1b,0x16,0x1a,0x1b,0xe,0x8,0x7,0x6,0x7,0x8,0x9,0x9,0x9,0x9,
	    0xe,0xe,0xe,0xe,0xf,0xf,0xf,0x10,0x12,0xf,0xf,0xe,0xd,0xe,0x10,0x12,0x13,0x14,0x14,0x15,0x16,0x17,0x17,0x16,0x16,0x15,0x15,0x14,0x14,0x14,0x13,0x13,0x13,0x13,0x13,0x13,0x12,0x13,0x12,0x12,0x13,0x14,0x15,0x16,0x18,0x1a,0x1b,0x1c,0x1d,0x1e,0x17,0x16,0x1a,0x1b,0xd,0x8,0x7,0x6,0x7,0x8,0x9,0x9,0x9,0x9,
	    0xe,0xe,0xe,0xe,0xe,0xf,0xf,0x10,0x11,0x10,0x10,0xd,0xc,0xd,0xf,0x11,0x12,0x13,0x13,0x14,0x15,0x15,0x16,0x15,0x15,0x15,0x14,0x14,0x14,0x14,0x13,0x13,0x13,0x13,0x13,0x13,0x12,0x12,0x12,0x12,0x13,0x13,0x15,0x17,0x18,0x1a,0x1c,0x1d,0x1d,0x1e,0x13,0x16,0x19,0x1b,0xc,0x7,0x7,0x6,0x6,0x7,0x8,0x9,0x9,0x9,
	    0xe,0xe,0xe,0xe,0xe,0xe,0xf,0x10,0x11,0x10,0xf,0xd,0xc,0xc,0xe,0xf,0x11,0x12,0x13,0x13,0x14,0x14,0x15,0x14,0x15,0x15,0x14,0x14,0x14,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x12,0x12,0x12,0x13,0x14,0x15,0x17,0x19,0x1b,0x1d,0x1d,0x1e,0x1c,0x12,0x15,0x19,0x1b,0xc,0x7,0x6,0x6,0x6,0x7,0x8,0x8,0x9,0x9,
	    0xe,0xe,0xe,0xe,0xf,0xf,0xf,0x10,0x11,0x10,0x10,0xd,0xc,0xc,0xd,0xe,0x10,0x11,0x12,0x12,0x13,0x14,0x14,0x14,0x14,0x14,0x14,0x14,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x12,0x12,0x13,0x13,0x14,0x15,0x17,0x19,0x1b,0x1d,0x1e,0x1f,0x1a,0x12,0x14,0x19,0x1b,0xd,0x7,0x6,0x6,0x7,0x7,0x7,0x8,0x9,0xa,
	    0xe,0xe,0xe,0xf,0xf,0xf,0x10,0x10,0x11,0x11,0x10,0xe,0xc,0xb,0xc,0xd,0xe,0xf,0x11,0x11,0x12,0x13,0x13,0x13,0x13,0x13,0x14,0x14,0x13,0x13,0x13,0x13,0x13,0x13,0x12,0x13,0x13,0x13,0x13,0x13,0x13,0x14,0x15,0x17,0x19,0x1b,0x1d,0x1e,0x1f,0x17,0x11,0x14,0x19,0x1b,0xe,0x6,0x6,0x6,0x7,0x8,0x8,0x8,0x9,0xa,
	    0xe,0xe,0xf,0xf,0xf,0xf,0xf,0x10,0x10,0x10,0xf,0xe,0xc,0xb,0xb,0xc,0xd,0xe,0x10,0x11,0x11,0x12,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x14,0x14,0x16,0x17,0x19,0x1b,0x1e,0x1f,0x1f,0x16,0x10,0x13,0x18,0x1b,0x11,0x5,0x6,0x7,0x8,0x9,0x9,0x8,0x9,0x9,
	    0xe,0xe,0xf,0xf,0xe,0xf,0xf,0x10,0x10,0x10,0xf,0xc,0xb,0xa,0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12,0x12,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x14,0x14,0x15,0x16,0x17,0x19,0x1b,0x1e,0x1f,0x1f,0x14,0x10,0x12,0x19,0x1c,0x16,0x4,0x5,0x6,0x7,0x8,0x8,0x8,0x9,0x9,
	    0xe,0xe,0xe,0xe,0xf,0xf,0xf,0x10,0x10,0x10,0xe,0xb,0x8,0xc,0xa,0xa,0xb,0xc,0xc,0xd,0xf,0x10,0x11,0x12,0x12,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x14,0x14,0x15,0x16,0x17,0x19,0x1b,0x1d,0x1f,0x1f,0x14,0x10,0x12,0x1a,0x1d,0x1a,0xb,0xc,0xe,0xe,0xf,0xf,0x10,0x11,0x11,
	    0xf,0xf,0xf,0xf,0xf,0x10,0x10,0x11,0x10,0x10,0xe,0xb,0xa,0xc,0xe,0xb,0xb,0xd,0xd,0xc,0xd,0xf,0x11,0x12,0x12,0x12,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x13,0x14,0x14,0x15,0x15,0x16,0x17,0x18,0x1a,0x1d,0x1f,0x1f,0x15,0x12,0x15,0x1a,0x1d,0x1d,0x15,0x15,0x16,0x16,0x15,0x15,0x15,0x16,0x14,
	};


void LED_displayFrame(void) {
	for(uint8_t row = 0; row < 32; row++) {
		/* for each "row" two rows are driven. One one the upper half and one on the lower (rowu and rowl) */
		uint8_t rowu[64], rowl[64];
		uint8_t yu = row;
		uint8_t yl = row + 32;
		for(uint8_t x = 0; x < 64; x++) {
			rowu[x] = PIXEL(x, yu);
			rowl[x] = PIXEL(x, yl);
		}

		HAL_GPIO_WritePin(LM_OE_GPIO_Port, LM_OE_Pin, GPIO_PIN_SET);
		LL_GPIO_WriteOutputPort(GPIOB, (LL_GPIO_ReadOutputPort(GPIOB) & ~0x1F) | row);

		for(int8_t bit = 0; bit < BITS_PER_PIXEL; bit++) {
			for(uint8_t clk = 0; clk < 64; clk++) {
				// count out 64 bits, then latch them
				GPIO_PinState pu, pl;
				pu = rowu[clk] & (1 << bit) ? GPIO_PIN_SET : GPIO_PIN_RESET;
				pl = rowl[clk] & (1 << bit) ? GPIO_PIN_SET : GPIO_PIN_RESET;



				HAL_GPIO_WritePin(LM_LAT_GPIO_Port, LM_LAT_Pin, GPIO_PIN_RESET);
				HAL_GPIO_WritePin(LM_CLK_GPIO_Port, LM_CLK_Pin, GPIO_PIN_RESET);

				HAL_GPIO_WritePin(LM_R1_GPIO_Port, LM_R1_Pin, pu);
				HAL_GPIO_WritePin(LM_G1_GPIO_Port, LM_G1_Pin, pu);
				HAL_GPIO_WritePin(LM_B1_GPIO_Port, LM_B1_Pin, pu);
				HAL_GPIO_WritePin(LM_R2_GPIO_Port, LM_R2_Pin, pl);
				HAL_GPIO_WritePin(LM_G2_GPIO_Port, LM_G2_Pin, pl);
				HAL_GPIO_WritePin(LM_B2_GPIO_Port, LM_B2_Pin, pl);

				HAL_GPIO_WritePin(LM_CLK_GPIO_Port, LM_CLK_Pin, GPIO_PIN_SET);
			}
			// latch in the data
			HAL_GPIO_WritePin(LM_LAT_GPIO_Port, LM_LAT_Pin, GPIO_PIN_SET);
			HAL_GPIO_WritePin(LM_OE_GPIO_Port, LM_OE_Pin, GPIO_PIN_RESET);
			// delay by xxxx * 1<<bit
			//HAL_Delay(1 * 1<<bit);
			for(uint32_t di = 0; di < 25 * (1<<bit); di++) {
				asm("nop");
			}
		}
	}
	HAL_GPIO_WritePin(LM_OE_GPIO_Port, LM_OE_Pin, GPIO_PIN_SET);
}
